<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Greia - Find an Agent</title>
<link rel="icon" type="image/png" href="../assets/greia (4).png"/>
<link href="../css/agents.css" rel="stylesheet"/>
<link href="../css/main.css" rel="stylesheet"/>
<link href="../css/global-nav.css" rel="stylesheet"/>
<script src="../js/global-nav.js"></script>
<script src="../js/global-search.js"></script>
<script src="../scripts/main.js"></script>

<style>
/* Carousel agent card styles */
.user-card {
  width: 220px;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  padding: 1.2em 1em 1.2em 1em;
  margin: 0 0 1em 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  min-height: 340px;
}

.user-photo-wrap {
  position: relative;
  width: 100px;
  height: 100px;
  margin-bottom: 1em;
}

.user-photo {
  width: 100px;
  height: 100px;
  object-fit: cover;
  border-radius: 50%;
  border: 3px solid #00ff5e8f;
  background: #f4f4f4;
  display: block;
}

.company-logo-overlay {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid #00ff59;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.10);
}

.company-logo-overlay img {
  width: 32px;
  height: 32px;
  object-fit: contain;
  border-radius: 50%;
  background: #fff;
}

.user-card .agent-name {
  font-weight: 700;
  font-size: 1.1em;
  margin-bottom: 0.2em;
  color: #222;
  text-align: center;
}

.user-card .agent-role {
  font-size: 0.98em;
  color: #00ff4c;
  font-weight: 600;
  margin-bottom: 0.1em;
  text-align: center;
}

.user-card .agent-profession,
.user-card .agent-tags,
.user-card .agent-address {
  font-size: 0.97em;
  color: #555;
  margin-bottom: 0.1em;
  text-align: center;
  word-break: break-word;
}

.user-card .agent-tags {
  color: #888;
  font-size: 0.95em;
}

.user-card .agent-address {
  color: #888;
  font-size: 0.95em;
}

/* Modern Agent Search Bar Styles */
.agent-search-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
  align-items: center;
  justify-content: center;
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 2px 12px rgba(53,66,74,0.08);
  padding: 18px 24px 12px 24px;
  margin: 2em auto 1.5em auto;
  max-width: 900px;
}

.agent-search-bar input,
.agent-search-bar select {
  padding: 12px 14px;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1em;
  background: #fafbfc;
  outline: none;
  transition: border 0.2s;
  min-width: 120px;
  margin: 0;
}

.agent-search-bar input:focus,
.agent-search-bar select:focus {
  border-color: #00ff5e;
  background: #fff;
}

.agent-search-bar button[type="submit"] {
  padding: 12px 28px;
  background: #00ffa6;
  color: #000000;
  border: none;
  border-radius: 8px;
  font-size: 1em;
  font-weight: 400;
  cursor: pointer;
  transition: background 0.18s;
  margin-left: 0.5em;
}

.agent-search-bar button[type="submit"]:hover {
  background: #0acb8e; /* darker teal */
  color: #000000;
}

@media (max-width: 700px) {
  .agent-search-bar {
    flex-direction: column;
    gap: 0.7em;
    padding: 12px 6px 10px 6px;
    max-width: 98vw;
  }
  .agent-search-bar input,
  .agent-search-bar select {
    width: 100%;
    min-width: 0;
    font-size: 0.98em;
  }
  .agent-search-bar button[type="submit"] {
    width: 100%;
    margin-left: 0;
  }
}

@media (max-width: 700px) {
  .user-card {
    width: 160px;
    min-width: 160px;
    max-width: 180px;
    margin: 0 0.3em 0.8em 0.3em;
    padding: 0.8em 0.4em;
    min-height: 220px;
  }
  .user-photo-wrap {
    width: 50px;
    height: 50px;
    margin-bottom: 0.5em;
  }
  .user-photo {
    width: 50px;
    height: 50px;
  }
  .company-logo-overlay {
    width: 28px;
    height: 28px;
  }
  .company-logo-overlay img {
    width: 24px;
    height: 24px;
  }
  .user-card .agent-name {
    font-size: 0.95em;
    margin-bottom: 0.15em;
  }
  .user-card .agent-role {
    font-size: 0.85em;
    margin-bottom: 0.1em;
  }
  .user-card .agent-profession,
  .user-card .agent-tags,
  .user-card .agent-address {
    font-size: 0.8em;
    margin-bottom: 0.08em;
  }
  #agents-carousel-track {
    gap: 8px;
    padding: 1em 0.3em;
  }
}

/* Top Row: Logo left, Action Bar right */
.top-row-logo-action {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1200px;
  margin: 96px auto 0 auto;
  padding: 0 5px;
  overflow: visible;
  width: 100%;
}

@media (max-width: 700px) {
  .top-row-logo-action {
    max-width: 100vw !important;
    width: 100vw !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 0 !important;
    margin: 80px 0 0 0 !important;
    padding: 0 8px !important;
    box-sizing: border-box !important;
  }
  .top-row-logo-action > div:first-child {
    width: auto !important;
    display: flex !important;
    justify-content: flex-start !important;
    align-items: center !important;
    margin-bottom: 0 !important;
    flex: 0 0 auto !important;
  }
  .top-row-logo-action > div:first-child img {
    display: block !important;
    margin: 0 !important;
    max-width: 36vw !important;
    height: 40px !important;
    max-height: 40px !important;
  }
  .top-row-logo-action > div:last-child {
    width: 120px !important;
    max-width: 120px !important;
    min-width: 0 !important;
    flex: 0 0 110px !important;
    gap: 8px !important;
    display: flex !important;
    justify-content: flex-end !important;
    align-items: center !important;
  }
  .top-row-logo-action > div:last-child button,
  .top-row-logo-action > div:last-child #friends-tab-btn,
  .top-row-logo-action > div:last-child #inbox-tab-btn,
  .top-row-logo-action > div:last-child #notifications-tab-btn,
  .top-row-logo-action > div:last-child #profile-tab-btn {
    font-size: 1em !important;
    padding: 8px 18px !important;
    min-width: 60px !important;
    height: 36px !important;
    border-radius: 999px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    gap: 6px !important;
  }
  .top-row-logo-action > div:last-child span {
    font-size: 1em !important;
  }
}
/* Tablet and mobile: larger action tabs container width */
@media (max-width: 1024px) {
  .top-row-logo-action > div:last-child {
    width: 160px !important;
    max-width: 160px !important;
    min-width: 0 !important;
    flex: 0 0 160px !important;
    gap: 10px !important;
  }
}
/* Extra small screens */
@media (max-width: 500px) {
  .top-row-logo-action > div:last-child {
    width: 80px !important;
    max-width: 80px !important;
    min-width: 0 !important;
    flex: 0 0 80px !important;
    gap: 4px !important;
  }
  .top-row-logo-action > div:last-child button,
  .top-row-logo-action > div:last-child #friends-tab-btn,
  .top-row-logo-action > div:last-child #inbox-tab-btn,
  .top-row-logo-action > div:last-child #notifications-tab-btn,
  .top-row-logo-action > div:last-child #profile-tab-btn {
    font-size: 0.85em !important;
    padding: 4px 10px !important;
    height: 24px !important;
    gap: 3px !important;
  }
  .top-row-logo-action > div:last-child span {
    font-size: 0.85em !important;
  }
}
  </style>
</head>
<body style="background:#f4f4f4;">
<!-- Navigation Bar -->
<nav class="navbar">
  <div class="navbar-thirds">
    <div class="navbar-third left">
      <ul class="nav-links left-links" style="position:relative; z-index:100;">
        <li class="dropdown" style="position:relative;">
          <a href="/pages/buy.html" style="position:relative; z-index:101;">Property</a>
          <ul class="dropdown-menu" style="top:100%; left:0; margin-top:0; padding-top:0; border-top:0;">
            <li><a href="/pages/buy.html">Buy</a></li>
            <li><a href="/pages/rent.html">Rent</a></li>
            <li><a href="/pages/commercial.html">Commercial</a></li>
            <li><a href="/pages/buy.html">Apartments</a></li>
            <li><a href="/pages/sell.html">Sell</a></li>
            <li><a href="/pages/valuations.html">Valuations</a></li>
            <li><a href="/pages/buy.html">New Homes</a></li>
          </ul>
        </li>
        <li class="dropdown" style="position:relative;">
          <a href="/pages/agents.html" style="color: rgb(78, 255, 146); position:relative; z-index:101;" class="referral-dropdown-toggle">Connect</a>
          <ul class="dropdown-menu" style="top:100%; left:0; margin-top:0; padding-top:0; border-top:0;">
            <li><a href="/pages/agents.html">Find an Agent</a>
            <li class="nested-dropdown" style="position: relative;">
              <a href="/pages/agents.html" class="referral-dropdown-toggle" tabindex="0" aria-haspopup="true" aria-expanded="false">Referral Agents ‚ñ∏</a>
              <ul class="dropdown-menu referral-dropdown" style="display:none; position: absolute; left: 100%; top: 0; background: white; list-style:none; padding:10px; border:1px solid #ccc; min-width: 220px; z-index: 2000;">
                <li><a href="/pages/agents.html?subtype=luxury">Luxury Home Agents</a></li>
                <li><a href="/pages/agents.html?subtype=lettings">Lettings Agents</a></li>
                <li><a href="/pages/agents.html?subtype=newhomes">New Homes Agents</a></li>
                <li><a href="/pages/agents.html?subtype=commercial">Commercial Agents</a></li>
                <li><a href="/pages/agents.html?subtype=residential">Residential Agents</a></li>
                <li><a href="/pages/agents.html?subtype=developer">Developer Agents</a></li>
                <li><a href="/pages/agents.html?subtype=timeshare">Timeshare Agents</a></li>
              </ul>
            </li>
            <li><a href="/pages/coaching.html">Coaching</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="navbar-third center">
      <div class="logo">
        <a href="/index.html">
          <img alt="Logo" src="../assets/greia (4).png" style="height: auto; max-height: 140px;"/>
        </a>
      </div>
    </div>
    <div class="navbar-third right">
      <ul class="nav-links right-links">
        <li>
          <a href="/pages/services.html" class="fancy-underline">Our Services</a>
        </li>
        <li>
          <a href="/pages/concierge.html" class="fancy-underline">Concierge</a>
        </li>
        <li class="dropdown" id="auth-menu">
          <a href="/pages/login.html" id="login-btn">Log In</a>
          <ul class="dropdown-menu" id="login-dropdown">
            <li><a href="/pages/login.html">Sign In</a></li>
            <li><a href="/pages/register.html">Register</a></li>
            <li><a href="/pages/forgot-password.html">Forgot Password?</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
  <button aria-label="Toggle navigation" class="hamburger-menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <!-- Mobile nav menu -->
  <div class="mobile-nav-overlay"></div>
  <div class="mobile-nav">
    <ul>
      <li class="dropdown">
        <a href="/pages/buy.html" class="dropdown-toggle">Property</a>
        <ul class="dropdown-menu">
          <li><a href="/pages/buy.html">Buy</a></li>
          <li><a href="/pages/rent.html">Rent</a></li>
          <li><a href="/pages/commercial.html">Commercial</a></li>
          <li><a href="/pages/buy.html">Apartments</a></li>
          <li><a href="/pages/sell.html">Sell</a></li>
          <li><a href="/pages/valuations.html">Valuations</a></li>
          <li><a href="/pages/buy.html">New Homes</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="/pages/agents.html" class="dropdown-toggle" style="color: rgb(78, 255, 146);">Connect</a>
        <ul class="dropdown-menu">
          <li><a href="/pages/agents.html">Find an Agent</a></li>
          <li><a href="/pages/agents.html">Referral Agents</a></li>
          <li><a href="/pages/coaching.html">Coaching</a></li>
        </ul>
      </li>
      <li><a href="/pages/services.html">Our Services</a></li>
      <li><a href="/pages/concierge.html">Concierge</a></li>
      <li class="dropdown" id="mobile-auth-menu">
        <a href="/pages/login.html" class="dropdown-toggle" id="mobile-login-btn">Log In</a>
        <ul class="dropdown-menu" id="mobile-login-dropdown">
          <li><a href="/pages/login.html">Sign In</a></li>
          <li><a href="/pages/register.html">Register</a></li>
          <li><a href="/pages/forgot-password.html">Forgot Password?</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav>

<!-- Top Row: Logo left, Action Bar right -->
<div class="top-row-logo-action" style="display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:96px auto 0 auto;padding:0 5px;overflow:visible;width:100%;">
  <!-- Logo on the left -->
  <div style="display:flex;align-items:center;overflow:visible;height:70px;">
    <img src="../assets/greiaconnectbig.png" alt="Connect Logo" style="height:110px;width:auto;display:block;object-fit:contain;overflow:visible;mix-blend-mode: darken;">
  </div>
  <!-- Action Bar on the right -->
  <div style="display:flex;align-items:center;gap:14px;position:relative;">
    <!-- Home Button (no dropdown) -->
    <button style="background:#c1c1c1;color:#1c0bff;border:none;border-radius:999px;padding:10px 28px;font-weight:400;font-size:1.02rem;box-shadow:0 1px 4px rgba(28,11,255,0.08);outline:none;cursor:pointer;transition:background 0.18s;display:flex;align-items:center;gap:8px;min-width:0;">
      <span style="font-size:1.1em;">üè†</span>
      <span style="font-size:1em;">Home</span>
    </button>
    <!-- Friends Tab -->
    <div style="position:relative;">
      <button id="friends-tab-btn" style="background:#fff;color:#1c0bff;border:1.5px solid #e0e0e0;border-radius:999px;padding:10px 28px;font-weight:500;font-size:1.02rem;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:0;">
        <span style="font-size:1.1em;">üë•</span>
        <span style="font-size:1em;">Friends</span>
      </button>
      <div id="friends-tab-dropdown" style="display:none;position:absolute;top:110%;right:0;min-width:220px;background:#fff;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,0.13);padding:16px 0;z-index:100;">
        <div style="padding:0 18px 10px 18px;font-weight:400;color:#1c0bff;">Your Friends</div>
        <ul style="list-style:none;padding:0 18px;margin:0;">
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">Jane Doe <span style="color:#bbb;font-size:0.9em;">(Online)</span></li>
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">John Smith <span style="color:#bbb;font-size:0.9em;">(Offline)</span></li>
          <li style="padding:6px 0;">Add more friends...</li>
        </ul>
      </div>
    </div>
    <!-- Inbox Tab -->
    <div style="position:relative;">
      <button id="inbox-tab-btn" style="background:#fff;color:#1c0bff;border:1.5px solid #e0e0e0;border-radius:999px;padding:10px 28px;font-weight:500;font-size:1.02rem;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:0;">
        <span style="font-size:1.1em;">‚úâÔ∏è</span>
        <span style="font-size:1em;">Inbox</span>
      </button>
      <div id="inbox-tab-dropdown" style="display:none;position:absolute;top:110%;right:0;min-width:260px;background:#fff;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,0.13);padding:16px 0;z-index:100;">
        <div style="padding:0 18px 10px 18px;font-weight:400;color:#1c0bff;">Recent Messages</div>
        <ul style="list-style:none;padding:0 18px;margin:0;">
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">Jane: "Hi, are you available?"</li>
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">Support: "Welcome to D4Rent!"</li>
          <li style="padding:6px 0;">View all messages...</li>
        </ul>
      </div>
    </div>
    <!-- Notifications Tab -->
    <div style="position:relative;">
      <button id="notifications-tab-btn" style="background:#fff;color:#1c0bff;border:1.5px solid #e0e0e0;border-radius:999px;padding:10px 28px;font-weight:500;font-size:1.02rem;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:0;">
        <span style="font-size:1.1em;">üîî</span>
        <span style="font-size:1em;">Notifications</span>
      </button>
      <div id="notifications-tab-dropdown" style="display:none;position:absolute;top:110%;right:0;min-width:260px;background:#fff;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,0.13);padding:16px 0;z-index:100;">
        <div style="padding:0 18px 10px 18px;font-weight:400;color:#1c0bff;">Notifications</div>
        <ul style="list-style:none;padding:0 18px;margin:0;">
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">You have 2 new messages</li>
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;">Profile updated successfully</li>
          <li style="padding:6px 0;">See all notifications...</li>
        </ul>
      </div>
    </div>
    <!-- Profile Tab -->
    <div style="position:relative;">
      <button id="profile-tab-btn" style="background:#fff;color:#1c0bff;border:1.5px solid #e0e0e0;border-radius:999px;padding:10px 28px;font-weight:500;font-size:1.02rem;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:0;">
        <span style="font-size:1.1em;">üë§</span>
        <span style="font-size:1em;">Profile</span>
      </button>
      <div id="profile-tab-dropdown" style="display:none;position:absolute;top:110%;right:0;min-width:200px;background:#fff;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,0.13);padding:16px 0;z-index:100;">
        <ul style="list-style:none;padding:0 18px;margin:0;">
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;"><a href="/pages/profile.html" style="color:#1c0bff;">View Profile</a></li>
          <li style="padding:6px 0;border-bottom:1px solid #f0f0f0;"><a href="/pages/settings.html" style="color:#1c0bff;">Settings</a></li>
          <li style="padding:6px 0;"><a href="/pages/logout.html" style="color:#e8491d;">Log Out</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<script>
  // Dropdown tab logic
  function setupTabDropdown(tabBtnId, dropdownId) {
    const btn = document.getElementById(tabBtnId);
    const dropdown = document.getElementById(dropdownId);
    if (!btn || !dropdown) return;
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      // Hide all other dropdowns
      document.querySelectorAll('.tab-dropdown-open').forEach(el => {
        if (el !== dropdown) el.style.display = 'none';
      });
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
      dropdown.classList.add('tab-dropdown-open');
    });
  }
  setupTabDropdown('friends-tab-btn', 'friends-tab-dropdown');
  setupTabDropdown('inbox-tab-btn', 'inbox-tab-dropdown');
  setupTabDropdown('notifications-tab-btn', 'notifications-tab-dropdown');
  setupTabDropdown('profile-tab-btn', 'profile-tab-dropdown');
  // Hide dropdowns when clicking outside
  document.addEventListener('click', function() {
    document.querySelectorAll('.tab-dropdown-open').forEach(el => {
      el.style.display = 'none';
      el.classList.remove('tab-dropdown-open');
    });
  });
</script>

<!-- Main Content: Split 2/3 - 1/3 -->
<div style="display:flex;max-width:1200px;margin:0 auto 2em auto;gap:36px;align-items:flex-start;">
  <!-- Left: 2/3 - Agent Discovery & Carousels -->
  <div style="flex:2;min-width:0;">
    <!-- Agent Search Bar -->
    <form class="agent-search-bar" id="agent-filter-form" style="margin:2em 0 2em 0;">
      <input autocomplete="off" id="filter-query" placeholder="Search agents..." style="flex:2; min-width:180px;" type="text"/>
      <select id="filter-role" style="min-width:140px;">
        <option value="">Agent Types</option>
        <option value="Service Agent">Service Agent</option>
        <option value="Real Estate Agent">Real Estate Agent</option>
      </select>
      <select id="filter-tag" style="min-width:140px;">
        <option value="">All Specialties</option>
        <!-- Tags will be populated dynamically based on agent type selection -->
      </select>
      <button type="submit">Search</button>
    </form>

    <!-- Featured Agents -->
    <section id="featured-agents-section" style="margin-bottom:3.5em;min-height:180px;">
      <h2 style="font-size:1.2rem;font-weight:400;color:#222;margin-bottom:0.5em;letter-spacing:0.01em;">Featured Agents</h2>
      <div id="featured-agents-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px;min-height:120px;"></div>
    </section>
    <!-- New Agents -->
    <section id="new-agents-section" style="margin-bottom:3.5em;min-height:160px;">
      <h2 style="font-size:1.1rem;font-weight:400;color:#222;margin-bottom:0.5em;letter-spacing:0.01em;">New Agents</h2>
      <div id="new-agents-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px;min-height:100px;"></div>
    </section>
    <!-- Service Agents -->
    <section id="service-agents-section" style="margin-bottom:3.5em;min-height:160px;">
      <h2 style="font-size:1.1rem;font-weight:400;color:#222;margin-bottom:0.5em;letter-spacing:0.01em;">Service Agents</h2>
      <div id="service-agents-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px;min-height:100px;"></div>
    </section>
    <!-- Real Estate Agents -->
    <section id="user-agents-section" style="margin-bottom:3.5em;min-height:160px;">
      <h2 style="font-size:1.1rem;font-weight:400;color:#222;margin-bottom:0.5em;letter-spacing:0.01em;">Real Estate Agents</h2>
      <div id="user-agents-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px;min-height:100px;"></div>
    </section>
  </div>
  <!-- Right: 1/3 - Leaderboard & Locked Features -->
  <aside style="flex:1;min-width:260px;max-width:340px;">
    <!-- Leaderboard -->
    <section id="leaderboard-section" style="background:#fff;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:1.5em 1em 1em 1em;margin-bottom:2em;">
      <h3 style="font-size:1.1rem;font-weight:400;color:#222;margin-bottom:1em;text-align:center;letter-spacing:0.01em;">Leaderboard</h3>
      <div id="leaderboard-chart" style="width:100%;padding:0 0.5em;">
        <!-- Mock leaderboard bar chart with custom emblems and font -->
        <div style="margin-bottom:10px;">
          <div style="display:flex;align-items:center;gap:8px;">
            <!-- Small purple emblem for 1st -->
            <span style="display:flex;align-items:center;">
              <svg width="16" height="16" viewBox="0 0 22 22" style="display:inline-block;vertical-align:middle;">
                <circle cx="11" cy="11" r="11" fill="url(#purpleGradient)" />
                <defs>
                  <linearGradient id="purpleGradient" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0%" stop-color="#a259ff"/>
                    <stop offset="100%" stop-color="#7f1fff"/>
                  </linearGradient>
                </defs>
              </svg>
            </span>
            <span style="flex:1;font-weight:400;color:#111;font-family:Arial,sans-serif;font-size:1.04em;">Sarah O'Connell</span>
            <span style="color:#888;font-size:0.95em;font-family:Arial,sans-serif;font-weight:300;">4.9</span>
          </div>
          <div style="background:#e0e7ff;border-radius:6px;height:16px;overflow:hidden;margin-top:3px;">
            <div style="background:#a259ff;height:100%;width:98%;border-radius:6px;"></div>
          </div>
        </div>
        <div style="margin-bottom:10px;">
          <div style="display:flex;align-items:center;gap:8px;">
            <!-- Small gold emblem for 2nd -->
            <span style="display:flex;align-items:center;">
              <svg width="16" height="16" viewBox="0 0 22 22" style="display:inline-block;vertical-align:middle;">
                <circle cx="11" cy="11" r="11" fill="url(#goldGradient)" />
                <defs>
                  <linearGradient id="goldGradient" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0%" stop-color="#ffd700"/>
                    <stop offset="100%" stop-color="#ffb300"/>
                  </linearGradient>
                </defs>
              </svg>
            </span>
            <span style="flex:1;font-weight:400;color:#111;font-family:Arial,sans-serif;font-size:1.04em;">James Murphy</span>
            <span style="color:#888;font-size:0.95em;font-family:Arial,sans-serif;font-weight:300;">4.8</span>
          </div>
          <div style="background:#e0e7ff;border-radius:6px;height:16px;overflow:hidden;margin-top:3px;">
            <div style="background:#ffd700;height:100%;width:96%;border-radius:6px;"></div>
          </div>
        </div>
        <div style="margin-bottom:10px;">
          <div style="display:flex;align-items:center;gap:8px;">
            <!-- Small silver emblem for 3rd -->
            <span style="display:flex;align-items:center;">
              <svg width="16" height="16" viewBox="0 0 22 22" style="display:inline-block;vertical-align:middle;">
                <circle cx="11" cy="11" r="11" fill="url(#silverGradient)" />
                <defs>
                  <linearGradient id="silverGradient" x1="0" y1="0" x2="1" y2="1">
                    <stop offset="0%" stop-color="#bfc1c2"/>
                    <stop offset="100%" stop-color="#e0e0e0"/>
                  </linearGradient>
                </defs>
              </svg>
            </span>
            <span style="flex:1;font-weight:400;color:#111;font-family:Arial,sans-serif;font-size:1.04em;">Aisling Byrne</span>
            <span style="color:#888;font-size:0.95em;font-family:Arial,sans-serif;font-weight:300;">4.7</span>
          </div>
          <div style="background:#e0e7ff;border-radius:6px;height:16px;overflow:hidden;margin-top:3px;">
            <div style="background:#bfc1c2;height:100%;width:94%;border-radius:6px;"></div>
          </div>
        </div>
        <div style="margin-bottom:10px;">
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="font-size:1.2em;">‚≠ê</span>
            <span style="flex:1;font-weight:400;color:#111;font-family:Arial,sans-serif;font-size:1.04em;">Michael Kelly</span>
            <span style="color:#888;font-size:0.95em;font-family:Arial,sans-serif;font-weight:300;">4.6</span>
          </div>
          <div style="background:#e0e7ff;border-radius:6px;height:16px;overflow:hidden;margin-top:3px;">
            <div style="background:#818cf8;height:100%;width:92%;border-radius:6px;"></div>
          </div>
        </div>
        <div style="margin-bottom:10px;">
          <div style="display:flex;align-items:center;gap:8px;">
            <span style="font-size:1.2em;">‚≠ê</span>
            <span style="flex:1;font-weight:400;color:#111;font-family:Arial,sans-serif;font-size:1.04em;">Emma Walsh</span>
            <span style="color:#888;font-size:0.95em;font-family:Arial,sans-serif;font-weight:300;">4.5</span>
          </div>
          <div style="background:#e0e7ff;border-radius:6px;height:16px;overflow:hidden;margin-top:3px;">
            <div style="background:#a5b4fc;height:100%;width:90%;border-radius:6px;"></div>
          </div>
        </div>
        <!-- ...add more as needed... -->
      </div>
    </section>
    <!-- News Section -->
    <section id="news-section" style="background:#fff;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:1.5em 1em 1em 1em;margin-bottom:2em;">
      <h3 style="font-size:1.1rem;font-weight:400;color:#222;margin-bottom:1em;text-align:center;letter-spacing:0.01em;font-family:Arial, sans-serif;">Latest News</h3>
      <div id="news-list" style="display:flex;flex-direction:column;gap:18px;">
        <a href="https://d4rent.ie/news/networking-features" target="_blank" style="position:relative;display:block;height:90px;border-radius:10px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.07);transition:box-shadow 0.2s;">
          <img src="../assets/istockphoto-1063301176-612x612.jpg" alt="Networking Features" style="width:100%;height:100%;object-fit:cover;display:block;">
          <div class="news-banner-overlay" style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.18);transition:background 0.3s;"></div>
          <div class="news-banner-text" style="position:absolute;bottom:0;left:0;width:100%;padding:12px 16px;color:#fff;font-weight:300;font-size:1.04em;font-family:Arial, sans-serif;text-shadow:none;">D4Rent launches new agent networking features</div>
        </a>
        <a href="https://d4rent.ie/news/dublin-rental-trends" target="_blank" style="position:relative;display:block;height:90px;border-radius:10px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.07);transition:box-shadow 0.2s;">
          <img src="../assets/capi_ea8a333aa8ea5107b2a5ba480bff7d21_341e4e558e61d8d949fb7650f1028aac.jpeg" alt="Rental Trends" style="width:100%;height:100%;object-fit:cover;display:block;">
          <div class="news-banner-overlay" style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.18);transition:background 0.3s;"></div>
          <div class="news-banner-text" style="position:absolute;bottom:0;left:0;width:100%;padding:12px 16px;color:#fff;font-weight:300;font-size:1.04em;font-family:Arial, sans-serif;text-shadow:none;">Market update: Dublin rental trends for summer</div>
        </a>
        <a href="https://d4rent.ie/news/agent-profile-tips" target="_blank" style="position:relative;display:block;height:90px;border-radius:10px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.07);transition:box-shadow 0.2s;">
          <img src="../assets/655d11199c7d23cb3b9e5fc1.webp" alt="Profile Tips" style="width:100%;height:100%;object-fit:cover;display:block;">
          <div class="news-banner-overlay" style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.18);transition:background 0.3s;"></div>
          <div class="news-banner-text" style="position:absolute;bottom:0;left:0;width:100%;padding:12px 16px;color:#fff;font-weight:300;font-size:1.04em;font-family:Arial, sans-serif;text-shadow:none;">Tips: How to get the most from your agent profile</div>
        </a>
      </div>
      <style>
        #news-list a .news-banner-text {
          font-family: Arial, sans-serif !important;
          font-weight: 300 !important;
          text-shadow: none !important;
        }
        #news-list a:hover .news-banner-overlay {
          background: rgba(0,0,0,0.55) !important;
        }
        #news-list a:hover {
          box-shadow: 0 4px 18px rgba(28,11,255,0.13);
        }
      </style>
    </section>
    <!-- Locked Features -->
    <section style="background:#fff;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,0.07);padding:1.5em 1em 1em 1em;text-align:center;">
      <div style="font-size:2.5em;color:#bbb;margin-bottom:0.5em;"><span>üîí</span></div>
      <div style="font-size:1.05em;color:#888;">More networking features coming soon.<br>Stay tuned!</div>
    </section>
  </aside>
</div>

<script>
// Helper functions
function getUserProfilePic(user) {
  if (user.profile_picture) {
    if (user.profile_picture.startsWith('http')) return user.profile_picture;
    if (user.profile_picture.startsWith('/uploads/')) return user.profile_picture;
    return '/uploads/' + user.profile_picture;
  }
  return '/assets/default-user.png';
}
function getCompanyLogo(user) {
  if (user.company_logo) {
    if (user.company_logo.startsWith('http')) return user.company_logo;
    if (user.company_logo.startsWith('/uploads/')) return user.company_logo;
    return '/uploads/' + user.company_logo;
  }
  return '';
}

// Render agent card (small, for grid)
function agentCard(user) {
  const companyLogo = getCompanyLogo(user);
  const tags = user.tags
    ? (Array.isArray(user.tags) ? user.tags.join(', ') : user.tags)
    : '';
  return `
    <div class="user-card" style="box-shadow:0 2px 12px rgba(0,0,0,0.08);background:#fff;border-radius:16px;padding:1.2em 1em;display:flex;flex-direction:column;align-items:center;position:relative;min-height:280px;">
      <a href="profile-public.html?id=${user.id}" style="text-decoration:none;color:inherit;display:flex;flex-direction:column;align-items:center;">
        <div class="user-photo-wrap" style="margin-bottom:1em;">
          <img class="user-photo" src="${getUserProfilePic(user)}" alt="${user.full_name || ''}">
          ${companyLogo ? `
            <span class="company-logo-overlay">
              <img src="${companyLogo}" alt="Company Logo">
            </span>
          ` : ''}
        </div>
        <div class="agent-name" style="font-weight:700;font-size:1.1em;margin-bottom:0.2em;color:#222;text-align:center;">${user.full_name || ''}</div>
        <div class="agent-role" style="font-size:0.98em;color:#e8491d;font-weight:600;margin-bottom:0.1em;text-align:center;">${user.role || ''}</div>
        <div class="agent-company" style="font-size:0.97em;color:#555;margin-bottom:0.1em;text-align:center;">${user.company_name || user.company || ''}</div>
        <div class="agent-profession" style="font-size:0.97em;color:#555;margin-bottom:0.1em;text-align:center;">${user.profession || ''}</div>
        <div class="agent-address" style="font-size:0.95em;color:#888;margin-bottom:0.1em;text-align:center;">${user.address || ''}</div>
        <div class="agent-tags" style="color:#888;font-size:0.95em;">${tags}</div>
      </a>
    </div>
  `;
}

// Render leaderboard (top agents by rating or fallback)
function renderLeaderboard(users) {
  const list = document.getElementById('leaderboard-list');
  if (!list) return;
  // Sort by rating or fallback to first 10
  let top = [];
  if (users.some(u => typeof u.rating === 'number')) {
    top = [...users].filter(u => typeof u.rating === 'number').sort((a, b) => b.rating - a.rating).slice(0, 10);
  } else {
    top = users.slice(0, 10);
  }
  list.innerHTML = top.map((u, i) => {
    // Simple sticker for top 3
    let sticker = '';
    if (i === 0) sticker = 'ü•á';
    else if (i === 1) sticker = 'ü•à';
    else if (i === 2) sticker = 'ü•â';
    else if (u.rating >= 4.5) sticker = '‚≠ê';
    return `<li style="display:flex;align-items:center;gap:10px;margin-bottom:0.5em;">
      <span style="font-size:1.2em;">${sticker}</span>
      <span style="font-weight:600;color:#1c0bff;">${u.full_name || 'Agent'}</span>
      ${typeof u.rating === 'number' ? `<span style="color:#888;font-size:0.95em;">(${u.rating.toFixed(1)})</span>` : ''}
    </li>`;
  }).join('');
}

// Render agent grids for each section
function renderAgentGrid(users, gridId, filterFn, max = 8) {
  const grid = document.getElementById(gridId);
  if (!grid) return;
  const filtered = filterFn ? users.filter(filterFn) : users;
  grid.innerHTML = filtered.slice(0, max).map(agentCard).join('');
}

document.addEventListener('DOMContentLoaded', async () => {
  // Define tag options for different agent types
  const agentTypeTags = {
    'Real Estate Agent': [
      'Lettings Agent',
      'Residential Agent', 
      'Commercial Agent',
      'Valuations Agent',
      'New Developments Agent',
      'Luxury Homes Agent',
      'Property Management Agent',
      'Investment Agent',
      'First Time Buyers Specialist',
      'Mortgage Advisor',
      'Auction Specialist'
    ],
    'Service Agent': [
      'Property Maintenance',
      'Cleaning Services',
      'Security Services',
      'Landscaping & Gardening',
      'Home Improvement',
      'Moving Services',
      'Legal Services',
      'Financial Services',
      'Insurance Services',
      'Property Inspection',
      'Energy Assessment',
      'Interior Design'
    ]
  };

  // Function to update tag dropdown based on selected agent type
  function updateTagOptions() {
    const roleSelect = document.getElementById('filter-role');
    const tagSelect = document.getElementById('filter-tag');
    const selectedRole = roleSelect.value;
    
    // Clear existing options except the first one
    tagSelect.innerHTML = '<option value="">All Specialties</option>';
    
    // Add relevant tags if an agent type is selected
    if (selectedRole && agentTypeTags[selectedRole]) {
      agentTypeTags[selectedRole].forEach(tag => {
        const option = document.createElement('option');
        option.value = tag;
        option.textContent = tag;
        tagSelect.appendChild(option);
      });
    }
  }

  // Add event listener to role dropdown
  document.getElementById('filter-role').addEventListener('change', updateTagOptions);

  // Initialize with default options
  updateTagOptions();

  // Fetch users/agents from backend
  let users = [];
  try {
    const res = await fetch(`${API_BASE_URL}/api/users`);
    if (res.ok) {
      users = await res.json();
      console.log('Loaded agents from database:', users.length);
    } else {
      console.error('Failed to fetch agents:', res.status);
    }
  } catch (e) {
    console.error('Error fetching agents:', e);
    users = [];
  }

  if (users.length > 0) {
    // Store agent data in localStorage for profile page access
    localStorage.setItem('agentsData', JSON.stringify(users));
    
    // Featured Agents: Show random selection of all agents (mix of both types)
    const shuffledUsers = [...users].sort(() => 0.5 - Math.random());
    renderAgentGrid(shuffledUsers, 'featured-agents-grid', null, 8);

    // New Agents: Sort by created_at (newest first)
    const newAgents = [...users].sort((a, b) => {
      const dateA = new Date(a.created_at || 0);
      const dateB = new Date(b.created_at || 0);
      return dateB - dateA;
    });
    renderAgentGrid(newAgents, 'new-agents-grid', null, 8);

    // Service Agents: Filter by role containing 'service'
    const serviceAgents = users.filter(u => u.role && u.role.toLowerCase().includes('service'));
    renderAgentGrid(serviceAgents, 'service-agents-grid', null, 8);

    // Real Estate Agents: Filter by role containing 'real estate'
    const realEstateAgents = users.filter(u => u.role && u.role.toLowerCase().includes('real estate'));
    renderAgentGrid(realEstateAgents, 'user-agents-grid', null, 8);

    console.log('Agent sections populated:', {
      total: users.length,
      service: serviceAgents.length,
      realEstate: realEstateAgents.length
    });
  } else {
    console.log('No agents found in database');
  }

  // Leaderboard
  renderLeaderboard(users);

  // Search/filter logic for featured grid
  document.getElementById('agent-filter-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const query = document.getElementById('filter-query').value.trim().toLowerCase();
    const role = document.getElementById('filter-role').value;
    const tag = document.getElementById('filter-tag').value;

    const filtered = users.filter(user => {
      // Match query against name, company, address, profession, tags
      const q = query;
      const match =
        !q ||
        (user.full_name && user.full_name.toLowerCase().includes(q)) ||
        (user.company_name && user.company_name.toLowerCase().includes(q)) ||
        (user.company && user.company.toLowerCase().includes(q)) ||
        (user.address && user.address.toLowerCase().includes(q)) ||
        (user.profession && user.profession.toLowerCase().includes(q)) ||
        (user.tags && (
          (Array.isArray(user.tags) && user.tags.join(',').toLowerCase().includes(q)) ||
          (typeof user.tags === 'string' && user.tags.toLowerCase().includes(q))
        ));
      if (!match) return false;
      
      // Filter by role/agent type
      if (role && user.role !== role) return false;
      
      // Filter by specific tag/specialty
      if (tag) {
        const tagsArr = Array.isArray(user.tags)
          ? user.tags.map(t => t.toLowerCase())
          : (user.tags ? user.tags.toLowerCase().split(',').map(t => t.trim()) : []);
        if (!tagsArr.includes(tag.toLowerCase())) return false;
      }
      
      return true;
    });

    // Update the featured agents grid with filtered results
    renderAgentGrid(filtered, 'featured-agents-grid', null, 12);
    
    // Update the section heading to show filter results
    const featuredSection = document.getElementById('featured-agents-section');
    const heading = featuredSection.querySelector('h2');
    if (query || role || tag) {
      const filterText = [];
      if (role) filterText.push(role + 's');
      if (tag) filterText.push(tag);
      if (query) filterText.push(`matching "${query}"`);
      heading.textContent = `Search Results: ${filterText.join(' - ')} (${filtered.length} found)`;
    } else {
      heading.textContent = 'Featured Agents';
    }
  });
});
</script>
<!-- Chatbot icon -->
<!-- Chatbot popup -->
</main>

<footer>
<div class="footer-container">
<div class="footer-image">
<img alt="D4Rent Footer Logo" src="../assets/greia (4).png" style="height: auto; max-height: 100px;"/>
</div>
<div class="footer-section">
<h3 style="font-size: smaller;; font-size: larger;">Contact Details</h3>
<p style="font-size: larger;">Greia</p>
<p style="font-size: larger;">36 Upper Baggot St, Ballsbridge, D4</p>
<p style="font-size: larger;">Phone: 01 442 7303</p>
<p style="font-size: larger;">087 169 9498</p>
<p>Email: <a href="mailto:info@greia.ie">info@greia.ie</a></p>
</div>
<div class="footer-section">
<h3 style="font-size: smaller;; font-size: larger;">Quick Links</h3>
<ul>
<li><a href="pages/buy.html">Buy</a></li>
<li><a href="pages/rent.html">Rent</a></li>
<li><a href="pages/sell.html">Sell</a></li>
<li><a href="pages/commercial.html">Commercial</a></li>
<li><a href="pages/agents.html">Agents</a></li>
<li><a href="pages/contact-us.html">Contact Us</a></li>
<li><a href="pages/listyourrentalsfree.html">List Your Rentals Free</a></li>
</ul>
</div>
<div class="footer-section">
<h3 style="font-size: smaller;; font-size: larger;">Policy Links</h3>
<ul>
<li><a href="pages/privacy-policy.html">Privacy Policy</a></li>
<li><a href="pages/terms-of-service.html">Terms of Service</a></li>
<li><a href="pages/cookie-policy.html">Cookie Policy</a></li>
</ul>
</div>
<div class="footer-section">
<h3 style="font-size: smaller;; font-size: larger;">Connect with Us</h3>
<ul>
<li><a href="https://www.facebook.com/profile.php?id=61577099380616" target="_blank">Facebook</a></li>
<li><a href="https://www.instagram.com/dublin4rent/" target="_blank">Instagram</a></li>
<li><a href="https://www.tiktok.com/@d4rent.ie" target="_blank">Tiktok</a></li>
</ul>
</div>
</div>
</footer>

<script src="/scripts/chatbot.js"></script>
<script src="/scripts/agents.js"></script>
<script>
  // Check user authentication status and update navigation
  document.addEventListener("DOMContentLoaded", function() {
    // Check if user is logged in (you can modify this logic based on your auth system)
    function isUserLoggedIn() {
      // Check for auth token in localStorage, sessionStorage, or cookies
      const token = localStorage.getItem('authToken') || sessionStorage.getItem('authToken');
      return token && token.length > 0;
    }

    function updateNavigation() {
      const isLoggedIn = isUserLoggedIn();
      
      // Desktop navigation
      const authMenu = document.getElementById('auth-menu');
      const loginBtn = document.getElementById('login-btn');
      const loginDropdown = document.getElementById('login-dropdown');
      
      // Mobile navigation
      const mobileAuthMenu = document.getElementById('mobile-auth-menu');
      const mobileLoginBtn = document.getElementById('mobile-login-btn');
      const mobileLoginDropdown = document.getElementById('mobile-login-dropdown');

      if (isLoggedIn) {
        // User is logged in - show direct link to dashboard
        
        // Desktop
        if (authMenu && loginBtn && loginDropdown) {
          authMenu.classList.remove('dropdown');
          loginBtn.textContent = 'myGREIA';
          loginBtn.href = '/pages/profile.html';
          loginDropdown.style.display = 'none';
        }
        
        // Mobile
        if (mobileAuthMenu && mobileLoginBtn && mobileLoginDropdown) {
          mobileAuthMenu.classList.remove('dropdown');
          mobileLoginBtn.textContent = 'myGREIA';
          mobileLoginBtn.href = '/pages/profile.html';
          mobileLoginBtn.classList.remove('dropdown-toggle');
          mobileLoginDropdown.style.display = 'none';
        }
      } else {
        // User is not logged in - show login dropdown
        
        // Desktop
        if (authMenu && loginBtn && loginDropdown) {
          authMenu.classList.add('dropdown');
          loginBtn.textContent = 'Log In';
          loginBtn.href = '/pages/login.html';
          loginDropdown.style.display = '';
        }
        
        // Mobile
        if (mobileAuthMenu && mobileLoginBtn && mobileLoginDropdown) {
          mobileAuthMenu.classList.add('dropdown');
          mobileLoginBtn.textContent = 'Log In';
          mobileLoginBtn.href = '/pages/login.html';
          mobileLoginBtn.classList.add('dropdown-toggle');
          mobileLoginDropdown.style.display = '';
        }
      }
    }

    // Initial navigation update
    updateNavigation();

    // Listen for storage changes (when user logs in/out in another tab)
    window.addEventListener('storage', function(e) {
      if (e.key === 'authToken') {
        updateNavigation();
      }
    });

    // Listen for custom login/logout events
    window.addEventListener('userLoggedIn', updateNavigation);
    window.addEventListener('userLoggedOut', updateNavigation);
  });
</script>
<script>
// Initialize global navigation
document.addEventListener('DOMContentLoaded', function() {
    if (typeof initializeGlobalNavigation === 'function') {
        initializeGlobalNavigation();
    }
    if (typeof initializeGlobalSearch === 'function') {
        initializeGlobalSearch();
    }
});
</script>
</body>
</html>